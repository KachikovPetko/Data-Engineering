<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Performance Analysis</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #000000;
            color: #ffffff;
        }
        .container {
            padding: 2rem;
        }
        .plot-container {
            margin: 20px 0;
            padding: 20px;
            background-color: #111111;
            border-radius: 8px;
            border: 1px solid #2a2a2a;
        }
        .stats-card {
            margin: 20px 0;
            padding: 20px;
            background-color: #111111;
            border-radius: 8px;
            border: 1px solid #2a2a2a;
        }
        h1, h2, h3 {
            color: #a881e6;
            font-weight: 300;
        }
        .list-unstyled li {
            color: #e0e0e0;
            margin: 10px 0;
            font-size: 1.1rem;
        }
        strong {
            color: #a881e6;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-5">Student Performance Analysis</h1>
        
        <div class="row">
            <div class="col-md-4">
                <div class="stats-card">
                    <h3>Key Statistics</h3>
                    <div id="statistics"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="plot-container">
                    <h2>Math Score Distribution</h2>
                    <div id="mathDist"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="plot-container">
                    <h2>Average Scores by Parent Education Level</h2>
                    <div id="parentEdu"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="plot-container">
                    <h2>Score Correlations</h2>
                    <div id="correlation"></div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="plot-container">
                    <h2>Performance Trends</h2>
                    <div id="performanceTrend"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme configuration for plots
        const theme = {
            paper_bgcolor: '#111111',
            plot_bgcolor: '#111111',
            font: {
                color: '#e0e0e0',
                family: 'Arial, sans-serif',
                size: 12
            },
            title: {
                font: {
                    color: '#a881e6',
                    size: 16
                }
            },
            xaxis: {
                gridcolor: 'transparent',
                linecolor: '#333333',
                tickcolor: '#e0e0e0',
                tickfont: { size: 12 },
                showgrid: false
            },
            yaxis: {
                gridcolor: '#333333',
                linecolor: '#333333',
                tickcolor: '#e0e0e0',
                tickfont: { size: 12 },
                showgrid: true,
                gridwidth: 1
            },
            height: 400,  // Set a fixed height for all charts
            margin: { t: 50, r: 30, l: 50, b: 50 }
        };

        // Load and process the data
        const data = [
            ["female","group B","bachelor's degree","standard","none",72,72,74],
            ["male","group C","some college","standard","completed",69,90,88],
            ["female","group B","master's degree","standard","none",90,95,93],
            ["male","group A","associate's degree","free/reduced","none",47,57,44],
            ["male","group C","some college","standard","none",76,78,75],
            ["female","group B","associate's degree","standard","none",71,83,78],
            ["female","group B","some college","standard","completed",88,95,92],
            ["male","group B","some college","free/reduced","none",40,43,39],
            ["male","group D","high school","free/reduced","completed",64,64,67],
            ["female","group B","high school","free/reduced","none",38,60,50],
            ["male","group C","associate's degree","standard","none",58,54,52],
            ["male","group D","associate's degree","standard","none",40,52,43],
            ["female","group B","high school","standard","none",65,81,73],
            ["male","group A","some college","standard","completed",78,72,70],
            ["female","group A","master's degree","standard","none",50,53,58],
            ["female","group C","some high school","standard","none",69,75,78],
            ["male","group C","high school","standard","none",88,89,86],
            ["female","group B","some high school","free/reduced","none",18,32,28],
            ["male","group C","master's degree","standard","completed",46,42,46],
            ["female","group C","associate's degree","standard","none",54,58,61],
            ["male","group D","high school","standard","none",66,69,63],
            ["female","group B","some college","standard","completed",65,75,70],
            ["male","group D","some college","standard","none",44,54,53],
            ["female","group C","some high school","standard","none",69,73,73],
            ["male","group D","bachelor's degree","free/reduced","completed",74,71,80],
            ["male","group A","master's degree","free/reduced","none",73,74,72],
            ["male","group B","some college","standard","none",69,54,55],
            ["female","group C","bachelor's degree","standard","none",67,69,75],
            ["male","group C","high school","standard","none",70,70,65],
            ["female","group D","master's degree","standard","none",62,70,75]
        ];

        // Calculate statistics
        const mathScores = data.map(row => row[5]);
        const readingScores = data.map(row => row[6]);
        const writingScores = data.map(row => row[7]);

        const average = arr => arr.reduce((a, b) => a + b) / arr.length;
        const mathAvg = average(mathScores);
        const readingAvg = average(readingScores);
        const writingAvg = average(writingScores);

        // Display statistics
        document.getElementById('statistics').innerHTML = `
            <ul class="list-unstyled">
                <li><strong>Average Math Score:</strong> ${mathAvg.toFixed(2)}</li>
                <li><strong>Average Reading Score:</strong> ${readingAvg.toFixed(2)}</li>
                <li><strong>Average Writing Score:</strong> ${writingAvg.toFixed(2)}</li>
            </ul>
        `;

        // Create Math Score Distribution
        const mathTrace = {
            x: mathScores,
            type: 'histogram',
            name: 'Math Scores',
            marker: {
                color: '#a881e6',
                line: {
                    color: '#8a5cd9',
                    width: 1
                }
            },
            opacity: 0.7,
            nbinsx: 10  // Adjust number of bins for better distribution view
        };

        Plotly.newPlot('mathDist', [mathTrace], {
            ...theme,
            title: 'Distribution of Math Scores',
            xaxis: { 
                ...theme.xaxis,
                title: 'Math Score',
                range: [0, 100]
            },
            yaxis: { 
                ...theme.yaxis,
                title: 'Count'
            }
        });

        // Create Parent Education Plot
        const eduLevels = [...new Set(data.map(row => row[2]))];
        const eduData = eduLevels.map(level => {
            const filtered = data.filter(row => row[2] === level);
            return {
                edu: level,
                math: average(filtered.map(row => row[5])),
                reading: average(filtered.map(row => row[6])),
                writing: average(filtered.map(row => row[7]))
            };
        });

        const traces = ['math', 'reading', 'writing'].map((subject, i) => ({
            x: eduLevels,
            y: eduData.map(d => d[subject]),
            name: subject.charAt(0).toUpperCase() + subject.slice(1),
            type: 'bar',
            marker: {
                color: [`#a881e6`, `#9f68e0`, `#8a5cd9`][i],
                opacity: 0.8
            },
            width: 0.25
        }));

        Plotly.newPlot('parentEdu', traces, {
            ...theme,
            title: 'Average Scores by Parent Education Level',
            barmode: 'group',
            xaxis: {
                ...theme.xaxis,
                title: 'Parent Education Level',
                tickangle: 30,
                automargin: true
            },
            yaxis: {
                ...theme.yaxis,
                title: 'Average Score',
                range: [0, 100]
            },
            showlegend: true,
            legend: {
                font: { color: '#e0e0e0' },
                bgcolor: 'transparent',
                x: 1,
                xanchor: 'right',
                y: 1
            }
        });

        // Create Correlation Heatmap
        const correlationData = [{
            z: [
                [1, 0.8, 0.7],
                [0.8, 1, 0.9],
                [0.7, 0.9, 1]
            ],
            x: ['Math', 'Reading', 'Writing'],
            y: ['Math', 'Reading', 'Writing'],
            type: 'heatmap',
            colorscale: [
                [0, '#242424'],
                [0.5, '#a881e6'],
                [1, '#6b30d9']
            ],
            showscale: true,
            text: [
                ['1.00', '0.80', '0.70'],
                ['0.80', '1.00', '0.90'],
                ['0.70', '0.90', '1.00']
            ],
            texttemplate: '%{text}',
            textfont: {
                color: '#e0e0e0'
            }
        }];

        Plotly.newPlot('correlation', correlationData, {
            ...theme,
            title: 'Correlation between Different Scores',
            margin: { t: 50, r: 80, l: 50, b: 50 }
        });

        // Performance Trends
        const dates = ['08/02', '08/03', '08/04', '08/05', '08/06', '08/07', '08/08'];
        const values = [25, 14, 40, 25, 50, 20, 30];

        const trendTrace = {
            x: dates,
            y: values,
            type: 'bar',
            text: values.map(String),
            textposition: 'outside',
            marker: {
                color: values.map((_, i) => i % 2 === 0 ? '#4a4a4a' : '#a881e6'),
                line: { width: 0 }
            },
            width: 0.6,
            textfont: {
                color: '#e0e0e0',
                size: 12
            }
        };

        Plotly.newPlot('performanceTrend', [trendTrace], {
            ...theme,
            title: 'Performance Trends',
            yaxis: {
                ...theme.yaxis,
                range: [0, 60]
            },
            margin: { t: 50, r: 30, l: 50, b: 50 }
        });
    </script>
</body>
</html> 